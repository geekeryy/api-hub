services:
  gateway:
    image: alpine:latest
    ports:
      - 8080:8080
    env_file:
      - ../../.env
    command: ["/app/gateway", "-f", "/app/etc/gateway-api.yaml"]
    volumes:
      - ../../api/gateway/etc/gateway-api.yaml:/app/etc/gateway-api.yaml
      - ../../build/gateway:/app/gateway
    depends_on:
      - auth
      - user
  oms:
    image: alpine:latest
    restart: always
    ports:
      - 8081:8081
    env_file:
      - ../../.env
    command: ["/app/oms", "-f", "/app/etc/oms-api.yaml"]
    volumes:
      - ../../api/oms/etc/oms-api.yaml:/app/etc/oms-api.yaml
      - ../../build/oms:/app/oms
    depends_on:
      - auth
      - user
  auth:
    image: alpine:latest
    ports:
      - 8880:8880
    env_file:
      - ../../.env
    command: ["/app/auth", "-f", "/app/etc/auth.yaml"]
    volumes:
      - ../../rpc/auth/etc/auth.yaml:/app/etc/auth.yaml
      - ../../build/auth:/app/auth
  user:
    image: alpine:latest
    ports:
      - 8881:8881
    env_file:
      - ../../.env
    command: ["/app/user", "-f", "/app/etc/user.yaml"]
    volumes:
      - ../../rpc/user/etc/user.yaml:/app/etc/user.yaml
      - ../../build/user:/app/user
    depends_on:
      - auth
  monitor:
    image: alpine:latest
    ports:
      - 8882:8882
    env_file:
      - ../../.env
    command: ["/app/monitor", "-f", "/app/etc/monitor.yaml"]
    volumes:
      - ../../rpc/monitor/etc/monitor.yaml:/app/etc/monitor.yaml
      - ../../build/monitor:/app/monitor

